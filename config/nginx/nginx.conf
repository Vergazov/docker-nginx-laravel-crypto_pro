server {
    # Слушаем порт 80
    listen 80;
    # Или, если используешь HTTPS (дальше), можно добавить 443
    # listen 443 ssl;

    # Корневая папка сайта
    root /var/www/html/public;
    
    # Главный файл, который ищется при запросе директории
    index index.php index.html;

    # Имя сервера (можно localhost, домен и т.д.)
    server_name localhost;

    # Главная локация — обрабатывает все запросы
    location / {
        # Сначала пытаемся отдать файл, если есть
        # Если нет — передаём на index.php (для фреймворков вроде Laravel)
        try_files $uri $uri/ /index.php?$query_string;
    }

    # Обработка PHP-файлов
    location ~ \.php$ {
        # Передаём запрос PHP-FPM
        fastcgi_pass php:9000;  # ← имя сервиса в docker-compose

        # Указываем, какой PHP-файл запускать
        fastcgi_index index.php;
        fastcgi_param SCRIPT_FILENAME /var/www/html/public$fastcgi_script_name;
        
        # Включаем стандартные параметры FastCGI
        include fastcgi_params;

        access_log /var/log/nginx/fastcgi-access.log;
        error_log /var/log/nginx/fastcgi-error.log debug;
    }

    # Запрещаем доступ к .htaccess, .env и другим скрытым файлам
    location ~ /\. {
        deny all;
        return 404;
    }
}